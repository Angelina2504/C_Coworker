# Backlog Refinement - Sous-tÃ¢ches Techniques
**Source** : [backlog-ccoworker.csv](file:///c:/code/C_Coworker/backlog-ccoworker%20-%20backlog-ccoworker.csv)
**Objectif** : DÃ©coupage technique pour les dÃ©veloppeurs.

---

## ğŸ¢ Ã‰pic : Gestion des Espaces

### US-01 : Liste des espaces
*En tant quâ€™admin et user, je veux voir la liste des espaces*
**Sous-tÃ¢ches :**
- [ ] **Back** : CrÃ©er le modÃ¨le `Space` (id, name, capacity, type, equipment).
- [ ] **Back** : CrÃ©er le contrÃ´leur `SpaceController->index()` qui rÃ©cupÃ¨re tous les espaces.
- [ ] **Front** : CrÃ©er la vue `spaces/index.php`.
- [ ] **Front** : IntÃ©grer le tableau HTML (Bootstrap/Tailwind) avec les colonnes : Nom, Type, CapacitÃ©.
- [ ] **Front** : Ajouter un message "Aucun espace" si la liste est vide.

### US-02 : DÃ©tail d'un espace
*En tant quâ€™admin et user, je veux voir le dÃ©tail d'un espace*
**Sous-tÃ¢ches :**
- [ ] **Back** : CrÃ©er la mÃ©thode `SpaceController->show($id)`.
- [ ] **Front** : CrÃ©er la vue `spaces/show.php`.
- [ ] **Front** : Afficher photo (placeholder), liste des Ã©quipements, capacitÃ©.
- [ ] **Front** : Ajouter un bouton "Retour Ã  la liste".

### US-03 : Ajouter un espace (Admin uniquement)
*En tant quâ€™admin, je veux ajouter un espace*
**Sous-tÃ¢ches :**
- [ ] **Front** : CrÃ©er le formulaire `spaces/create.php` (Nom, CapacitÃ© [number], Type [select], Ã‰quipements [checkbox]).
- [ ] **Back** : CrÃ©er la route `POST /spaces`.
- [ ] **Back** : Validation des donnÃ©es (Nom requis, CapacitÃ© > 0).
- [ ] **Database** : Insertion SQL `INSERT INTO spaces ...`.
- [ ] **Front** : Redirection vers la liste avec message flash "Espace crÃ©Ã©".

### US-04 : Modifier un espace
*En tant quâ€™admin, je veux modifier un espace*
**Sous-tÃ¢ches :**
- [ ] **Back** : CrÃ©er la mÃ©thode `SpaceController->edit($id)` (rÃ©cupÃ¨re les infos actuelles).
- [ ] **Front** : CrÃ©er la vue `spaces/edit.php` (formulaire prÃ©-rempli).
- [ ] **Back** : GÃ©rer l'`UPDATE` en base de donnÃ©es.

### US-05 : Supprimer un espace
*En tant quâ€™admin, je veux supprimer un espace*
**Sous-tÃ¢ches :**
- [ ] **Back** : VÃ©rifier s'il y a des rÃ©servations futures liÃ©es (Bloquant ou Cascade ? -> RÃ¨gle : Bloquant).
- [ ] **Front** : Ajouter un bouton "Supprimer" avec une modale de confirmation JS `confirm()`.
- [ ] **Back** : ExÃ©cuter le `DELETE`.

---

## ğŸ“… Ã‰pic : Gestion des RÃ©servations

### US-06 : CrÃ©er une rÃ©servation
*En tant quâ€™admin et user, je veux crÃ©er une rÃ©servation*
**Sous-tÃ¢ches :**
- [ ] **Back** : CrÃ©er le modÃ¨le `Reservation` (id, space_id, user_id, start_time, end_time).
- [ ] **Front** : Formulaire de rÃ©servation (Datepicker, SÃ©lecteur de crÃ©neaux).
- [ ] **Back** : ContrÃ´le de cohÃ©rence (Fin > DÃ©but, Date >= Aujourd'hui).
- [ ] **Algo** : VÃ©rification de disponibilitÃ© (`EmpÃªcher les conflits` - voir US-09).

### US-07 : Modifier une rÃ©servation
*En tant quâ€™admin et user, je veux modifier une rÃ©servation*
**Sous-tÃ¢ches :**
- [ ] **Front** : Vue d'Ã©dition (changement d'horaire ou de salle).
- [ ] **Back** : Re-vÃ©rifier la disponibilitÃ© sur le nouveau crÃ©neau.

### US-08 : Supprimer une rÃ©servation
*En tant quâ€™admin et user, je veux supprimer une rÃ©servation*
**Sous-tÃ¢ches :**
- [ ] **Front** : Bouton d'annulation sur le dashboard ou le dÃ©tail.
- [ ] **Back** : Soft delete ou Hard delete ? (DÃ©cision : Hard delete pour le MVP).

### US-09 : EmpÃªcher les conflits (RÃ¨gle MÃ©tier Critique)
*EmpÃªcher deux rÃ©servations sur un mÃªme crÃ©neau*
**Sous-tÃ¢ches :**
- [ ] **Back** : Ã‰crire une requÃªte SQL de vÃ©rification :
  `SELECT count(*) FROM reservations WHERE space_id = ? AND start < ? AND end > ?`
- [ ] **Back** : Retourner une erreur bloquante si count > 0.
- [ ] **Front** : Afficher l'erreur "CrÃ©neau indisponible".

---

## ğŸ“Š Ã‰pic : Administration

### US-10 : Planning hebdomadaire
*En tant qu'admin, je veux voir les rÃ©servations par jour et heure*
**Sous-tÃ¢ches :**
- [ ] **Lib** : Choisir une librairie (FullCalendar) ou faire un tableau HTML custom "Lundi Ã  Vendredi".
- [ ] **Back** : Endpoint API JSON pour fournir les Ã©vÃ©nements.
- [ ] **Front** : Affichage des blocs de rÃ©servation dans le calendrier.

### US-11 : Tableau de bord
*En tant qu'admin, je veux voir rapidement les espaces libres et occupÃ©s*
**Sous-tÃ¢ches :**
- [ ] **Back** : RequÃªte "Espaces libres maintenant" (`NOT IN` rÃ©servations actuelles).
- [ ] **Back** : RequÃªte "5 prochaines rÃ©servations".
- [ ] **Front** : CrÃ©er la vue `dashboard.php` avec des cartes statistiques.

---

## ğŸ‘¥ Ã‰pic : Gestion des Utilisateurs

### US-12 Ã  US-16 : CRUD Utilisateur
**Sous-tÃ¢ches Globales :**
- [ ] **Base** : Table `users` (id, nom, prenom, email, mot_de_passe_hash, role [admin/user]).
- [ ] **Auth** : SystÃ¨me de Login/Logout (Session PHP).
- [ ] **Middleware** : VÃ©rification des droits (Admin seule pour US-12, 13, 14, 16).
